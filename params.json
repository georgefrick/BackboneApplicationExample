{"name":"Backbone Routed Tabs Example","tagline":"Using JQuery and Backbone as a simple application framework","body":"### Bringing Order To Chaos.\r\nBy extending Backbone.js Router to add, remove and manage an instance of JQuery UI Tabs; you can build a single page web application without the mess. Organize your code into \"modules\", and launch the modules within tabs. \r\n\r\nEach module can be developed independently; giving the application a real 'windowed' feel on a single page. The application is focusing on kick starting applications and helping users learn backbone. From there you can use it as an application skeleton; or just a fun example to refer back to. \r\n\r\n### But I Don't Know Backbone?\r\n1. [Nick Gauthier's  Introduction To Backbone](http://www.youtube.com/watch?v=PqtYcHyyWJA&feature=plcp)\r\n2. [If you only have 30 minutes.](http://www.youtube.com/watch?v=PcTVQyrWSSs)\r\n3. [Tuts Plus on Backbone.js](http://net.tutsplus.com/tutorials/javascript-ajax/getting-started-with-backbone-js/)\r\n4. [Learning the RESTful side.](http://www.youtube.com/watch?v=uykzCfu1RiQ)\r\n\r\n### See It Live\r\n[Backbone Routed Application Live Demo](http://animud.net:9090/bbapp/)\r\n\r\n### Features:\r\n1. Support for singleton tabs, reopening selects the previously opened tab.\r\n2. Support for multiple tabs; uniquely identified.\r\n3. You can easily add tab history, re-open, etc. (Not included)\r\n4. Scope is managed; parts of the application can be built individually and scope to their portion of the page.\r\n\r\n### How It Works\r\n\r\nCreate a special Backbone.Router, that has the two templates needed for adding a tab to Jquery UI Tabs; the list element and the content.\r\n```\r\nApplication.Router = Backbone.Router.extend({\r\n  initialize:function (options) {\r\n    this.el = options.el;\r\n    this.tabTemplate = Handlebars.loadTemplate(\"tab\");\r\n    this.tabContentTemplate = Handlebars.loadTemplate(\"tabContent\");            \r\n  },\r\n```\r\n\r\nCreate the routes; similar to struts, this will be \"what urls go where\"; then add a blank function so that the url never looks like my.com/my.html#thelastcommand\r\n```\r\n  routes:{\r\n    \"\":\"showHome\",\r\n    \"newBookList\":\"newBookList\",\r\n    \"newTodoList\":\"newTodoList\",\r\n    \"newCalculator\":\"newCalculator\",\r\n    \"closeAll\":\"closeAllTabs\"\r\n  },\r\n  showHome:function () {\r\n    // do nothing\r\n  },\r\n```\r\n\r\nCreate the addTab function. This function adds a new tab to the user interface, and returns a \r\nunique id identifying the div where the content goes.\r\n\r\nThe user can provide just a name, or everything (name, content, id)\r\n```\r\n    addTab : function(tabInfo) {\r\n      var current = {\r\n        // Defaults\r\n        'name' : \"New Tab\",\r\n        'content' : \"\",\r\n        'show' : true,\r\n        'id' : Math.guid()\r\n      };\r\n      var attr, val;\r\n      var attrs = {};\r\n\r\n      // Just name passed in? or an object full of properties.\r\n      if (typeof tabInfo === 'object') {\r\n        attrs = tabInfo;\r\n      } else {\r\n        attrs.name = tabInfo;\r\n      }\r\n\r\n      // Look for passed in options that override defaults and set them.\r\n      for (attr in attrs) {\r\n        val = attrs[attr];\r\n        if (current[attr] !== undefined && !_.isEqual(current[attr], val)) {\r\n          current[attr] = val;\r\n        }\r\n      }\r\n\r\n      // Construct the new tab, consisting of the tab and the tab content.\r\n      this.el.find(\".ui-tabs-nav:first\").append(this.tabTemplate(current));\r\n      this.el.append(this.tabContentTemplate(current));\r\n      this.el.tabs(\"refresh\");\r\n\r\n      // If the user opted not to show the tab, open in the background.\r\n      if (current.show) {\r\n        this.selectTabById(current.id);\r\n      }\r\n      return current.id;\r\n    },\r\n```\r\n\r\nTime to add that ability to select by id. Just look for the tab with that URL and get the parent index. This is the newer JQuery UI 1.9 way of doing it. There is also a check to make sure the tab is open.\r\n```\r\n    selectTabById : function(tabId) {\r\n      var index = $('#tabs a[href=\"#' + tabId + '\"]').parent().index();\r\n      return $(\"#\" + tabId).length \r\n               && $(\"#tabs\").tabs( \"option\", \"active\",index);\r\n    },\r\n```\r\n\r\nAnother example of tab manipulation; this will close everything but the 'home' tab. You could have it close that too of course.\r\n```\r\n    closeAllTabs:function () {\r\n      var tabCount = $('#tabs >ul >li').size();\r\n      while (tabCount > 1) {\r\n        var tab = $( \"#tabs\" ).find( \".ui-tabs-nav li:eq(1)\" ).remove();\r\n        var panelId = tab.attr( \"aria-controls\" );\r\n        $( \"#\" + panelId ).remove();\r\n        $( \"tabs\" ).tabs( \"refresh\" );\r\n        tabCount--;\r\n      }\r\n      Backbone.history.navigate(\"\"); // for now.\r\n    },\r\n```\r\n\r\nNow, lets open a simple module. This calculator module can be opened as many times as the user wishes. They'll get a new calculator and can operate separately on all of them. Shown here, is the routing function that creates an instance and places it in a tab.\r\n```\r\n  newCalculator:function () {\r\n    // For the calculator, we allow multiple tabs...\r\n    var tabId = \"calculator-\" + Math.guid();\r\n    var tabName = \"Calculator\";\r\n    var calc = new Calculator.CalculatorView();\r\n    var uniqueId = this.addTab({\r\n      'id' : tabId,\r\n      'name' : tabName\r\n    });\r\n    var tabContent = $(\"#\" + uniqueId);\r\n      tabContent.empty();\r\n      tabContent.append(calc.render().el);                       \r\n      Backbone.history.navigate(\"#\");\r\n    },\r\n```\r\n\r\nWhat about something more important; where the user can only have a single instance open? We can track the unique ID and check if it is still on the page. Other than that, creation of the tab is similar to the calculator example.\r\n```\r\n    newBookList:function () {\r\n      if (!this.openBookShelf \r\n           || ($(\"#\" + this.openBookShelf).length == 0)) {\r\n        var tabId = \"book-shelf\" + Math.guid();\r\n        var tabName = \"Book Shelf\";\r\n        var shelf = new BookDatabase.Shelf();\r\n        this.openBookShelf = this.addTab({\r\n          'id' : tabId,\r\n          'name' : tabName\r\n        });\r\n        var tabContent = $(\"#\" + this.openBookShelf);\r\n        tabContent.empty();\r\n        tabContent.append(shelf.render().el);\r\n      } else if (this.openBookShelf) {\r\n        this.selectTabById(this.openBookShelf);\r\n      }\r\n      Backbone.history.navigate(\"\"); // for now.\r\n    },\r\n  });\r\n```\r\n\r\nYou could very easily create a Backbone model/collection pair to track open tabs and even remember them; since the tab was opened by a URL. Also, because of this URL setup, a the user can be sent to the application with a specific tab open.\r\n\r\nI encourage you to review the rest of the source code and even run the application. I would love any feedback.\r\n\r\n### Running The Application\r\nSimply build the application with Maven and deploy to Tomcat 7. \r\n \r\n### Support or Contact\r\nYou can contact the author (@georgefrick) through GitHub or via email at george.frick@gmail.com.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}